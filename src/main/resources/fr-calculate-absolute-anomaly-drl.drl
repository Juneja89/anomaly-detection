import com.oaknorth.drools.RatioValue;
import com.oaknorth.drools.Record;

rule "rule 1 calculate absolute majority anomaly"
no-loop true
salience "70"
    when
        finance : FinanceData($recordList : records)
        $record : Record(ratioName == "Adjusted Gross Leverage", $ratioValueList: ratioValues) from $recordList
        total : List(size > 1) from collect(
         RatioValue( absoluteAnomaly > 1 ) from $ratioValueList )
    then
        System.out.println("rule 1 : total is::"+ total);
        $record.setAbsoluteMajorityAnomaly(1);
        System.out.println("absolute majority anomaly"+ finance.getRecords().get(0).getAbsoluteMajorityAnomaly());
end

rule "rule 2 calculate absolute majority anomaly"
no-loop true
salience "60"
    when
        finance : FinanceData($recordList : records)
        $record : Record(ratioName == "Adjusted Gross Leverage", $ratioValueList: ratioValues) from $recordList
        total : List(size > 1) from collect(
         RatioValue( absoluteAnomaly <= 1 ) from $ratioValueList )
         
    then
        System.out.println("rule 2 : total is::"+ total);
        for(RatioValue value : $record.getRatioValues()){
            System.out.println("absoluteAnomaly value is::"+ value.getAbsoluteAnomaly());
        }
        $record.setAbsoluteMajorityAnomaly(0);
        finance.setRecords($recordList);
end