import com.oaknorth.drools.Record;
import com.oaknorth.drools.RatioValue;

rule "rule 1 calculate absolute majority anomaly"
lock-on-active
    when
        finance : FinanceData($recordList : records)
        record : Record(ratioName == "Adjusted Gross Leverage", $ratioValueList: ratioValues) from $recordList
        $total : Number(doubleValue > 1) from accumulate(
         RatioValue( $p : absoluteAnomaly )sum( $p ) from $ratioValueList )
    then
    System.out.println("rule 1 : total is::"+ $total);
        record.setAbsoluteMajorityAnomaly(1);
        update(finance);
end

rule "rule 2 calculate absolute majority anomaly"
lock-on-active
    when
        finance : FinanceData($recordList : records)
        record : Record(ratioName == "Adjusted Gross Leverage", $ratioValueList: ratioValues) from $recordList
        $total : Number(doubleValue <= 1) from accumulate(
         RatioValue( $p : absoluteAnomaly )sum( $p ) from $ratioValueList )
    then
    System.out.println("rule 2 : total is::"+ $total);
        record.setAbsoluteMajorityAnomaly(0);
        update(finance);
end
